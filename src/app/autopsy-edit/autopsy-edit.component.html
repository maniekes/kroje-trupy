<div class="autopsy-protocol-header">
  <h2>Autopsy Protocol Editor</h2>
</div>

<form [formGroup]="autopsyForm" (ngSubmit)="saveAutopsy()" class="autopsy-form">
  <mat-form-field appearance="fill">
    <mat-label>Case Number</mat-label>
    <input matInput formControlName="caseNumber">
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Deceased Name</mat-label>
    <input matInput formControlName="deceasedName">
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Age</mat-label>
    <input matInput type="number" formControlName="age">
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Gender</mat-label>
    <mat-select formControlName="gender">
      <mat-option value="Male">Male</mat-option>
      <mat-option value="Female">Female</mat-option>
      <mat-option value="Other">Other</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Date of Death</mat-label>
    <input matInput [matDatepicker]="picker1" formControlName="dateOfDeath">
    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
    <mat-datepicker #picker1></mat-datepicker>
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Date of Autopsy</mat-label>
    <input matInput [matDatepicker]="picker2" formControlName="dateOfAutopsy">
    <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
    <mat-datepicker #picker2></mat-datepicker>
  </mat-form-field>

  <!-- Include the previously discussed fields here -->

  <mat-form-field appearance="fill">
    <mat-label>Place of Death</mat-label>
    <input matInput formControlName="placeOfDeath">
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Cause of Death</mat-label>
    <input matInput formControlName="causeOfDeath">
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Manner of Death</mat-label>
    <mat-select formControlName="mannerOfDeath">
      <mat-option value="Natural">Natural</mat-option>
      <mat-option value="Accident">Accident</mat-option>
      <mat-option value="Homicide">Homicide</mat-option>
      <mat-option value="Suicide">Suicide</mat-option>
      <mat-option value="Undetermined">Undetermined</mat-option>
    </mat-select>
  </mat-form-field>

  <div formGroupName="findings">
    <mat-form-field appearance="fill">
      <mat-label>External Examination</mat-label>
      <textarea matInput formControlName="externalExamination"></textarea>
    </mat-form-field>

    <div formGroupName="internalExamination">
      <mat-form-field appearance="fill" *ngIf="brain$ | async as data">
        <mat-label>Brain</mat-label>
        <input type="text" matInput formControlName="brain" [matAutocomplete]="brainAuto">
        <mat-autocomplete #brainAuto="matAutocomplete">
          <mat-option *ngFor="let suggestion of data" [value]="suggestion.value">
            {{suggestion.value}}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>

      <mat-form-field appearance="fill" *ngIf="heart$ | async as data">
        <mat-label>Heart</mat-label>
        <input type="text" matInput formControlName="heart" [matAutocomplete]="heartAuto">
        <mat-autocomplete #heartAuto="matAutocomplete">
          <mat-option *ngFor="let suggestion of data" [value]="suggestion.value">
            {{suggestion.value}}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>


      <!-- Repeat for other internal organs as needed -->
      <mat-form-field appearance="fill" *ngIf="lungs$ | async as data">
        <mat-label>Lungs</mat-label>
        <input type="text" matInput formControlName="lungs" [matAutocomplete]="lungsAuto">
        <mat-autocomplete #lungsAuto="matAutocomplete">
          <mat-option *ngFor="let suggestion of data" [value]="suggestion.value">
            {{suggestion.value}}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>

      <mat-form-field appearance="fill" *ngIf="liver$ | async as data">
        <mat-label>Liver</mat-label>
        <input type="text" matInput formControlName="liver" [matAutocomplete]="liverAuto">
        <mat-autocomplete #liverAuto="matAutocomplete">
          <mat-option *ngFor="let suggestion of data" [value]="suggestion.value">
            {{suggestion.value}}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>

      <mat-form-field appearance="fill" *ngIf="kidneys$ | async as data">
        <mat-label>Kidneys</mat-label>
        <input type="text" matInput formControlName="kidneys" [matAutocomplete]="kidneysAuto">
        <mat-autocomplete #kidneysAuto="matAutocomplete">
          <mat-option *ngFor="let suggestion of data" [value]="suggestion.value">
            {{suggestion.value}}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Other Notes</mat-label>
        <textarea matInput formControlName="otherNotes"></textarea>
      </mat-form-field>
    </div>

    <mat-form-field appearance="fill">
      <mat-label>Toxicology Results</mat-label>
      <textarea matInput formControlName="toxicologyResults"></textarea>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Microscopic Examinations</mat-label>
      <textarea matInput formControlName="microscopicExaminations"></textarea>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Conclusion</mat-label>
      <textarea matInput formControlName="conclusion"></textarea>
    </mat-form-field>
  </div>

  <button mat-raised-button color="primary" type="submit" [disabled]="!autopsyForm.valid">Save Protocol</button>
</form>


<div class="autopsy-protocol-footer">
  <p>Confidential - For authorized personnel only</p>
</div>
